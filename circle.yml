## Customize the test machine
machine:
  php:
    # Default: 5.6.17 @see https://circleci.com/docs/1.0/build-image-trusty/#php
    version: 7.1.3

# This will be added to the `/etc/hosts` file
  hosts:
    ixde.dev: 127.0.0.1

dependencies:
  pre:
    # Disable Xdebug @see https://circleci.com/docs/1.0/language-php/#xdebug
    - rm /opt/circleci/php/$(phpenv global)/etc/conf.d/xdebug.ini
    # No password is required for the MySQL user `ubuntu`
    - mysql -u ubuntu -e "create database ix_de"
    - .bin/drush si standard --db-url=mysql://ubuntu@localhost/ix_de --account-name='Norman KÃ¤mper-Leymann' --account-pass='12 Characters.' --account-mail=nl@cbe-digital.de --site-mail=nl@cbe-digital.de --site-name=d8.dev -y
    - .bin/drush en admin_toolbar, admin_toolbar_tools, devel, devel_generate, kint -y && drush pmu contact -y
    - .bin/drush config-set system.performance css.preprocess 0 -y
    - .bin/drush config-set system.performance js.preprocess 0 -y

# These commands are triggered only after a successful (green) build.
deployment:
  dev:
    branch: develop
    commands:
      - ssh ix@89.19.229.211 'cd /var/www/html/d8-test/scripts/deploy && . develop.sh'